# 08.04 ì •ê·œë¶„í¬ì™€ ì¤‘ì‹¬ê·¹í•œì •ë¦¬

```

    [ì°¸ê³  : ë‚œìˆ˜ ìƒì„± numpy]
    - np.random.rand : ê· ì¼ë¶„í¬ ìƒ ë‚œìˆ˜ ìƒì„±
    - np.random.randn : ì •ê·œë¶„í¬ ìƒ ë‚œìˆ˜ ìƒì„±
    - np.random.randint : ê· ì¼ë¶„í¬ ìƒ ë‚œìˆ˜ 1ê°œ ìƒì„±
    
    ```

## 1) ì‚¬ì´íŒŒì´ë¥¼ ì‚¬ìš©í•œ ì •ê·œë¶„í¬ì˜ ì‹œë®¬ë ˆì´ì…˜



```python
# ìƒ˜í”Œë§ ì—†ì´ ì´ë¡ ì  ë¶„í¬ë„ ê·¸ë¦¬ê¸° (pdfì— ë”°ë¼)

# 1. í™•ë¥ ë³€ìˆ˜ ìƒì„±
mu = 0
std = 1
rv = sp.stats.norm(mu,std)

# 2. í™•ë¥ ë³€ìˆ˜ê°’ ìƒì„±
xx = np.linspace(-3,3,1000)

# 3. í™•ë¥ ê°’ ìƒì„± -> ë¶„í¬ ê·¸ë¦¬ê¸°
plt.plot(xx,rv.pdf(xx))
```




    [<matplotlib.lines.Line2D at 0x121772bd0>]




![png](output_2_1.png)



```python
# ìƒ˜í”Œë§ í†µí•´ ì •ê·œë¶„í¬ë„ ê·¸ë¦¬ê¸°

# 1. í™•ë¥ ë³€ìˆ˜ ìƒì„±
mu = 0
std = 1
rv = sp.stats.norm(mu,std)

# 2. ìƒ˜í”Œë§
x = rv.rvs(100)

# 3. ë¶„í¬ë„ ê·¸ë¦¬ê¸°
sns.distplot(x, kde=True, fit=sp.stats.norm)
```




    <matplotlib.axes._subplots.AxesSubplot at 0x121941f10>




![png](output_3_1.png)


## 2) ì˜ˆì œ : ì£¼ì‹ ìˆ˜ìµë¥ 

    - ê³¼ê±° ì•½ 10ë…„ ê°„ì˜ ë‚˜ìŠ¤ë‹¥ ì£¼ì‹ ìˆ˜ìµë¥ 


```python
import pandas_datareader.data as web

symbol = "NASDAQCOM"
data = pd.DataFrame()
data[symbol] = web.DataReader(
    symbol, data_source="fred", start="2009-01-01", end="2020-05-11")[symbol]
data = data.dropna()
data.plot(legend=False)
plt.xlabel("ë‚ ì§œ")
plt.title("ë‚˜ìŠ¤ë‹¥ ì§€ìˆ˜")
plt.show()
```


![png](output_5_0.png)



```python
daily_returns = data.pct_change().dropna()
mean = daily_returns.mean().values[0]
std = daily_returns.std().values[0]
print("í‰ê·  ì¼ê°„ìˆ˜ìµë¥ : {:3.2f}%".format(mean * 100))
print("í‰ê·  ì¼ê°„ë³€ë™ì„±: {:3.2f}%".format(std * 100))
```

    í‰ê·  ì¼ê°„ìˆ˜ìµë¥ : 0.07%
    í‰ê·  ì¼ê°„ë³€ë™ì„±: 1.27%



```python
sns.distplot(daily_returns, kde=False)
ymin, ymax = plt.ylim()
plt.vlines(x=mean, ymin=0, ymax=ymax, ls="--")
plt.ylim(0, ymax)
plt.title("ë‚˜ìŠ¤ë‹¥ ì§€ìˆ˜ì˜ ì¼ê°„ìˆ˜ìµë¥  ë¶„í¬")
plt.xlabel("ì¼ê°„ìˆ˜ìµë¥ ")
plt.show()
```


![png](output_7_0.png)


## 3) Q-Q í”Œë¡¯

    - í‘œë³¸ ë°ì´í„°ê°€ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ëŠ”ì§€ ë¶„í¬ ëª¨ì–‘ì„ í† ëŒ€ë¡œ í™•ì¸
    - í‘œë³¸ê°’ ==> ìœ„ì¹˜ê°’ ==> ë¶„ìœ„ìˆ˜(ìœ„ì¹˜ê°’(y)ì„ ê°–ê¸° ìœ„í•œ ì´ë¡ ì  xê°’) ==> Q-Q (í‘œë³¸ê°’ vs ë¶„ìœ„ìˆ˜)
    
```


1. í‘œë³¸ ë°ì´í„°ë¥¼ ì •ë ¬(sort, ordering)

2. í•˜ë‚˜í•˜ë‚˜ì˜ í‘œë³¸ ë°ì´í„°ê°€ ì „ì²´ ë°ì´í„° ì¤‘ì˜ ëª‡ % ì •ë„ì— í•´ë‹¹í•˜ëŠ”ì§€ ìœ„ì¹«ê°’ì„ êµ¬í•œë‹¤. ìœ„ì¹«ê°’ìœ¼ë¡œëŠ” íŠ¹ì • ìˆœìœ„(order)ì˜ ê°’ì´ ë‚˜íƒ€ë‚  ê°€ëŠ¥ì„±ì´ ë†’ì€ ê°’ì„ ëœ»í•˜ëŠ” ìˆœì„œí†µê³„ëŸ‰(order statistics)ì´ë¼ëŠ” ê°’ì„ ì´ìš©í•œë‹¤.
   
3. ê° í‘œë³¸ ë°ì´í„°ì˜ ìœ„ì¹«ê°’ì´ ì •ê·œë¶„í¬ì˜ ëˆ„ì í™•ë¥ í•¨ìˆ˜(cdf) ê°’ì´ ë˜ëŠ” í‘œì¤€ ì •ê·œë¶„í¬ì˜ í‘œë³¸ê°’ì„ êµ¬í•œë‹¤. ì¦‰ í™•ë¥ ê°’ì— ëŒ€í•œ ëˆ„ì í™•ë¥ í•¨ìˆ˜ì˜ ì—­í•¨ìˆ˜ ê°’ì„ êµ¬í•œë‹¤. ì´ë¥¼ í‘œë³¸ ì •ê·œë¶„í¬ì˜ ë¶„ìœ„í•¨ìˆ˜(quantile function)ê°’ì´ë¼ê³  í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ í‘œë³¸ ì •ê·œë¶„í¬ì˜ 1%ì˜ ë¶„ìœ„í•¨ìˆ˜ê°’ì€  ğ¹âˆ’1(0.01) , ì•½ -2.326ì´ë‹¤.

4. ì •ë ¬ëœ í‘œë³¸ ë°ì´í„°(ordered values)ì™€ ê·¸ì— ëŒ€ì‘í•˜ëŠ” ë¶„ìœ„ìˆ˜(theoretical quantiles)ë¥¼ í•˜ë‚˜ì˜ ìŒìœ¼ë¡œ ê°„ì£¼í•˜ì—¬ 2ì°¨ì› ê³µê°„ì— í•˜ë‚˜ì˜ ì (point)ìœ¼ë¡œ ê·¸ë¦°ë‹¤.

5. ëª¨ë“  í‘œë³¸ì— ëŒ€í•´ 2ë¶€í„° 4ê¹Œì§€ì˜ ê³¼ì •ì„ ë°˜ë³µí•˜ì—¬ ìŠ¤ìºí„° í”Œë¡¯ì„ ì™„ì„±í•œë‹¤.

```


```python
# 1. í‘œë³¸ ë°ì´í„° ì •ë ¬

data = np.random.normal(loc=0, scale=1, size = 100)
data_sorted = np.sort(data)
```


```python
# 2. ìœ„ì¹˜ê°’ êµ¬í•˜ê¸° (order statistics)

from scipy.stats.morestats import _calc_uniform_order_statistic_medians

position = _calc_uniform_order_statistic_medians(len(data))
```


```python
# 3. ë¶„ìœ„ìˆ˜(qf) êµ¬í•˜ê¸° => ìœ„ì¹˜ê°’ = ì •ê·œë¶„í¬ cdfê°’ ì´ ë˜ëŠ” í‘œì¤€ì •ê·œë¶„í¬ì˜ í‘œë³¸ê°’(x=qf)ì„ êµ¬í•˜ê¸°
# cdfì˜ ì—­í•¨ìˆ˜ êµ¬í•˜ê¸° ex) cdf(x) = ìœ„ì¹˜ê°’1, cdf(x2) = ìœ„ì¹˜ê°’2
# 

rv = sp.stats.norm(0,1)
qf = rv.ppf(position)
```


```python
# 4. ordered valueì™€ ë¶„ìœ„ìˆ˜

plt.scatter(data_sorted, qf)
```




    <matplotlib.collections.PathCollection at 0x124faaad0>




![png](output_12_1.png)


## 3-1) Q-Q í”Œë¡¯ íŒ¨í‚¤ì§€

    - sp.stats.probplot(  )


```python
# ì •ê·œë¶„í¬ ë°ì´í„°ì˜ Q-Q í”Œë¡¯

np.random.seed(0)
data = np.random.randn(100)
sp.stats.probplot(data,plot=plt)
plt.show()
```


![png](output_14_0.png)



```python
# ì •ê·œë¶„í¬ê°€ ì•„ë‹Œ ë°ì´í„°ì˜ Q-Q í”Œë¡¯ : ë°ì´í„°ì˜ ì–‘ ëì´ ì§ì„ ì´ ì•„ë‹Œ íœ˜ì–´ì§„ ìƒíƒœ

np.random.seed(0)
x_unif = np.random.rand(100)
sp.stats.probplot(x_unif,plot=plt)
plt.show()
```


![png](output_15_0.png)


## 3-2) ì˜ˆì œ

```

ì •ê·œë¶„í¬ë¡œë¶€í„° ë‚˜ì˜¨  ğ‘ ê°œì˜ í‘œë³¸ì˜ í‘œë³¸í‰ê· ì´ ì •ê·œë¶„í¬ê°€ ëœë‹¤ëŠ” ê²ƒì„ ì‹œë®¬ë ˆì´ì…˜ê³¼ Q-Q í”Œë¡¯ì„ ì‚¬ìš©í•˜ì—¬ ë³´ì—¬ë¼.

(1)  ğ‘=2 ì¼ ë•Œ

(2)  ğ‘=10 ì¼ ë•Œ

```


```python
np.random.seed(0)
sample = np.random.randn(5000, 2)   # 2ê°œì˜ í‘œë³¸ë½‘ê¸°ë¥¼ 5000ë²ˆ ì‹œë®¬ë ˆì´ì…˜ í•œ ê²ƒ
sample_mean = sum(sample)/len(sample)  # 5000ë²ˆ ëŒë ¤ì„œ ì–»ì€ ê° í‘œë³¸í‰ê· ì´ ë‚˜ì˜¬ ê²ƒ
sp.stats.probplot(sample_mean,plot=plt)
plt.show()
```


![png](output_17_0.png)



```python
np.random.seed(0)
sample = np.random.randn(5000, 10)  # 10ê°œì˜ í‘œë³¸ë½‘ê¸°ë¥¼ 5000ë²ˆ ì‹œë®¬ë ˆì´ì…˜ í•œ ê²ƒ
sample_mean = sum(sample)/len(sample)  # 5000ë²ˆ ëŒë ¤ì„œ ì–»ì€ ê° í‘œë³¸í‰ê· ì´ ë‚˜ì˜¬ ê²ƒ
sp.stats.probplot(sample_mean,plot=plt)
plt.show()
```


![png](output_18_0.png)

